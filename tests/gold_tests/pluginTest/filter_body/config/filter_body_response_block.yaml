# Configuration for blocking responses with sensitive data.
rules:
  - name: "sensitive_response_block"
    filter:
      direction: response
      status: [200]
      headers:
        - name: "Content-Type"
          patterns:
            - "application/json"
            - "text/html"
      body_patterns:
        - "SSN:"
        - "password:"
    # Use log-only action because response body blocking is inherently racy:
    # the response headers (including Content-Length) are committed before the
    # body is inspected, so blocking the body causes a Content-Length mismatch.
    action: [log]

