schema_version: 1
owner: nobody
rcpt: All
schemes: [https, http]

mappings:
  - alias:
    - inbound.testing.example.com
    origin: https://origin.example.com
  - alias:
      - http://(.*.myalias.com
    origin: http://origin3.example.com
    regex_map: true

rules:
  default:
    deny_methods: [ POST, PUT, DELETE ]
    header_rewrite: |-
      # If Cookie : ADCDownloadAuth is missing then
      # 302 to developer.example.com/unauthorized/
      cond %{COOKIE:Tasty} ="" [AND]
      cond %{CLIENT-IP} ^127\.0\.0\.1|10\..*)/ [NOT]
        set-redirect 302 https://inbound.example.com/unauthorized/ [L]
      # If Origin serves a 000, 500 501 502 503 then
      # 302 to inboud.example.com/unauthorized/
