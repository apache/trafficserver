(program (programItem (section SEND_REQUEST { (sectionBody (conditional (ifStatement if (condition (expression (term (factor (comparison (comparable nexthop.host) == (value "parent.example.com")))))) (block { (blockItem (statement outbound.req.X-Via-Parent = (value "yes") ;)) })))) })) (programItem (section SEND_RESPONSE { (sectionBody (conditional (ifStatement if (condition (expression (term (factor (comparison (comparable outbound.req.X-Via-Parent) == (value "yes")))))) (block { (blockItem (statement inbound.resp.X-Next-Host = (value "{nexthop.host}") ;)) (blockItem (statement inbound.resp.X-Next-Port = (value "{nexthop.port}") ;)) (blockItem (statement inbound.resp.X-Next-Strategy = (value "{nexthop.strategy}") ;)) })))) })) <EOF>)
